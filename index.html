<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>一路小跑</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="一路小跑">
<meta property="og:url" content="http://jkyeo.com/index.html">
<meta property="og:site_name" content="一路小跑">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一路小跑">
  
    <link rel="alternative" href="/atom.xml" title="一路小跑" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">一路小跑</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jkyeo.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-SplashView-一行代码解决闪屏页-广告页-iOS-Swift-篇" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-iOS-Swift-篇/" class="article-date">
  <time datetime="2016-07-10T13:30:57.000Z" itemprop="datePublished">2016-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-iOS-Swift-篇/">SplashView - 一行代码解决闪屏页(广告页) - iOS(Swift) 篇</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>关于 SplashView 详细接受可以参考 Android 版: <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-Android-篇/">SplashView-一行代码解决闪屏页-广告页-Android-篇</a></p>
        
          <p class="article-more-link">
            <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-iOS-Swift-篇/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/07/10/SplashView-一行代码解决闪屏页-广告页-iOS-Swift-篇/" data-id="cisxysllm0004imwkzt7dij2e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-SplashView-一行代码解决闪屏页-广告页-Android-篇" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-Android-篇/" class="article-date">
  <time datetime="2016-07-10T12:19:22.000Z" itemprop="datePublished">2016-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-Android-篇/">SplashView - 一行代码解决闪屏页(广告页) - Android 篇</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>闪屏页或者广告页 (SplashView) 在众多 App 里是比较常见的。一般来说 SplashView 有以下职责：</p>
<ul>
<li>在合适的时机显示 SplashView - 可控性</li>
<li>下载、缓存、更新图片</li>
<li>回调响应图片点击事件</li>
<li>倒计时 Dismiss View，主动跳过 Dissmiss View</li>
<li>本地没有缓存时，显示默认图片或者不显示 SplashView</li>
</ul>
        
          <p class="article-more-link">
            <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-Android-篇/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/07/10/SplashView-一行代码解决闪屏页-广告页-Android-篇/" data-id="cisxysll50000imwkvviobijz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/view/">view</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-学习-Swift-Moya（二）-Moya-SwiftyJSON-RxSwift" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/29/学习-Swift-Moya（二）-Moya-SwiftyJSON-RxSwift/" class="article-date">
  <time datetime="2016-06-29T13:23:25.000Z" itemprop="datePublished">2016-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/29/学习-Swift-Moya（二）-Moya-SwiftyJSON-RxSwift/">学习 Swift Moya（二）- Moya + SwiftyJSON + RxSwift</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Moya_+_RxSwift"><a href="#Moya_+_RxSwift" class="headerlink" title="Moya + RxSwift"></a>Moya + RxSwift</h2><p>Moya + RxSwift 最简单的使用方法是这样的：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">provider = <span class="type">RxMoyaProvider</span>&lt;<span class="type">ApiService</span>&gt;()</div><div class="line">provider.request(<span class="type">ApiService</span>.<span class="type">Function</span>(<span class="string">"param"</span>)).subscribe &#123; (event) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">switch</span> event &#123;</div><div class="line">    <span class="keyword">case</span> .<span class="type">Next</span>(<span class="keyword">let</span> response):</div><div class="line">        <span class="comment">// do something like refresh ui</span></div><div class="line">    <span class="keyword">case</span> .<span class="type">Error</span>(<span class="keyword">let</span> error):</div><div class="line">        <span class="built_in">print</span>(error)</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">break</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Object_Mapper"><a href="#Object_Mapper" class="headerlink" title="Object Mapper"></a>Object Mapper</h2><p>结合 Object Mapper 可以很方便的将 Moya.Response  转换成对象输出。Moya 官方也给出了几个典型的 ObjectMapper Extension :</p>
<ul>
<li><a href="https://github.com/ivanbruel/Moya-ObjectMapper" target="_blank" rel="external">Moya-ObjectMapper</a> - ObjectMapper bindings for Moya for easier JSON serialization</li>
<li><a href="https://github.com/AvdLee/Moya-SwiftyJSONMapper" target="_blank" rel="external">Moya-SwiftyJSONMapper</a> - SwiftyJSON bindings for Moya for easier JSON serialization</li>
<li><a href="https://github.com/wattson12/Moya-Argo" target="_blank" rel="external">Moya-Argo</a> - Argo bindings for Moya for easier JSON serialization</li>
<li><a href="https://github.com/sunshinejr/Moya-ModelMapper" target="_blank" rel="external">Moya-ModelMapper</a> - ModelMapper bindings for Moya for easier JSON serialization</li>
<li><a href="https://github.com/spxrogers/Moya-Gloss" target="_blank" rel="external">Moya-Gloss</a> - Gloss bindings for Moya for easier JSON serialization</li>
<li><a href="https://github.com/DroidsOnRoids/Moya-JASON" target="_blank" rel="external">Moya-JASON</a> - JASON bindings for Moya for easier JSON serialization </li>
</ul>
<p>然而前段开发遇到的接口往往是这样的:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"resultCode"</span>:<span class="number">200</span>,</div><div class="line">    <span class="attr">"resultMsg"</span>:<span class="string">"查询成功!"</span>,</div><div class="line">    <span class="attr">"data"</span>:&#123;</div><div class="line">        <span class="attr">"city"</span>:<span class="string">"北京"</span>,</div><div class="line">        <span class="attr">"temperature"</span>:<span class="string">"8℃~20℃"</span>,</div><div class="line">        <span class="attr">"weather"</span>:<span class="string">"晴转霾"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>或者这样的：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"resultCode"</span>:<span class="number">200</span>,</div><div class="line">    <span class="attr">"resultMsg"</span>:<span class="string">"查询成功!"</span>,</div><div class="line">    <span class="attr">"data"</span>:[</div><div class="line">        &#123;</div><div class="line">            <span class="attr">"city"</span>:<span class="string">"北京"</span>,</div><div class="line">            <span class="attr">"temperature"</span>:<span class="string">"8℃~20℃"</span>,</div><div class="line">            <span class="attr">"weather"</span>:<span class="string">"晴转霾"</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            <span class="attr">"city"</span>:<span class="string">"南京"</span>,</div><div class="line">            <span class="attr">"temperature"</span>:<span class="string">"12℃~21℃"</span>,</div><div class="line">            <span class="attr">"weather"</span>:<span class="string">"晴"</span></div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>也就是说，接口想要返回的业务数据外总是“包裹”了一层状态数据来标记这一次业务返回的成功、失败以及失败的原因。</p>
<p>那么，对 Moya.Response  做 map 处理后直接得到业务对象(也就是 “data” 下的数据，或为 object，或为 array) 岂不是更优雅？类似的问题在 Android 开放中有讨论过:</p>
<blockquote>
<p><a href="/2016/03/01/Retrofit-RxJava-业务状态重定向及分离/">Retrofit + RxJava 业务状态重定向及分离</a></p>
</blockquote>
<p>这篇文章就来讨论在 Moya + RxSwift 环境下如何实现这样的 mapper 数据分离</p>
<h2 id="Moya_+_RxSwift_+_SwiftyJSON__u4E1A_u52A1_u72B6_u6001_u91CD_u5B9A_u5411_u53CA_u5206_u79BB"><a href="#Moya_+_RxSwift_+_SwiftyJSON__u4E1A_u52A1_u72B6_u6001_u91CD_u5B9A_u5411_u53CA_u5206_u79BB" class="headerlink" title="Moya + RxSwift + SwiftyJSON 业务状态重定向及分离"></a>Moya + RxSwift + SwiftyJSON 业务状态重定向及分离</h2><p>首先我们以聚合数据提供的电影票房查询接口为例:<br>对照 Moya Docs，很容易的建立以下 ApiService:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> apiProvider = <span class="type">RxMoyaProvider</span>&lt;<span class="type">ApiService</span>&gt;()</div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ApiService</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">GetRank</span>(area: <span class="type">String</span>?)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ApiService</span>: <span class="title">TargetType</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> baseURL: <span class="type">NSURL</span> &#123;<span class="keyword">return</span> <span class="type">NSURL</span>(string: <span class="string">"http://v.juhe.cn"</span>)!&#125;</div><div class="line">    <span class="keyword">var</span> path: <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</div><div class="line">        <span class="keyword">case</span> .<span class="type">GetRank</span>(<span class="number">_</span>):</div><div class="line">            <span class="keyword">return</span> <span class="string">"/boxoffice/rank"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> method: <span class="type">Moya</span>.<span class="type">Method</span> &#123;</div><div class="line">        <span class="keyword">return</span> .<span class="type">GET</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> parameters: [<span class="type">String</span>: <span class="type">AnyObject</span>]? &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</div><div class="line">        <span class="keyword">case</span> .<span class="type">GetRank</span>(<span class="keyword">let</span> area):</div><div class="line">            <span class="keyword">return</span> [</div><div class="line">                <span class="string">"area"</span>: <span class="literal">nil</span> == area ? <span class="string">""</span> : area!,</div><div class="line">                <span class="comment">// 这里是我的测试 key，理论上是免费的，如果失效，请自行申请替换</span></div><div class="line">                <span class="comment">// 接口详情地址: https://www.juhe.cn/docs/api/id/44</span></div><div class="line">                <span class="string">"key"</span>: <span class="string">"e8ec41002b1441dc9126d7bbf259b747"</span></div><div class="line">            ]</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> sampleData: <span class="type">NSData</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">""</span>.dataUsingEncoding(<span class="type">NSUTF8StringEncoding</span>)!</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里补充一点，如果想要在每一次请求的 header 或者 params 中插入一些公关参数(如 platform, sys_ver 和 uid 等等)，可以通过自定义 Endpoint Closure 方式实现。类似于 Android Okhttp 中的 Network Intercepor:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> headerFields: <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="type">String</span>&gt; = [</div><div class="line">    <span class="string">"platform"</span>: <span class="string">"iOS"</span>,</div><div class="line">    <span class="string">"sys_ver"</span>: <span class="type">String</span>(<span class="type">UIDevice</span>.version())</div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">let</span> appendedParams: <span class="type">Dictionary</span>&lt;<span class="type">String</span>, <span class="type">AnyObject</span>&gt; = [</div><div class="line">    <span class="string">"uid"</span>: <span class="string">"123456"</span></div><div class="line">]</div><div class="line"></div><div class="line"><span class="keyword">let</span> endpointClosure = &#123; (target: <span class="type">ApiService</span>) -&gt; <span class="type">Endpoint</span>&lt;<span class="type">ApiService</span>&gt; <span class="keyword">in</span></div><div class="line">    <span class="keyword">let</span> url = target.baseURL.<span class="type">URLByAppendingPathComponent</span>(target.path).absoluteString</div><div class="line">    <span class="keyword">return</span> <span class="type">Endpoint</span>(<span class="type">URL</span>: url, sampleResponseClosure: &#123;.<span class="type">NetworkResponse</span>(<span class="number">200</span>, target.sampleData)&#125;, method: target.method, parameters: target.parameters)</div><div class="line">        .endpointByAddingParameters(appendedParams)</div><div class="line">        .endpointByAddingHTTPHeaderFields(headerFields)</div></pre></td></tr></table></figure>
<p>然后 apiProvider 的初始化就是这样的:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> apiProvider = <span class="type">RxMoyaProvider</span>&lt;<span class="type">ApiService</span>&gt;(endpointClosure: endpointClosure)</div></pre></td></tr></table></figure>
<p>更多的，我们还可以自定义 requestClosure, stubClosure, manager 和 plugins 来实现更多的需求。具体可参见  <a href="https://github.com/Moya/Moya/tree/master/docs" target="_blank" rel="external">Moya Docs</a></p>
<p>好了，言归正传。</p>
<p>分析接口返回的 json 数据:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"resultcode"</span>: <span class="string">"200"</span>,</div><div class="line">  <span class="attr">"reason"</span>: <span class="string">"success"</span>,</div><div class="line">  <span class="attr">"result"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"rid"</span>: <span class="string">"1"</span>,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"惊天魔盗团2"</span>,</div><div class="line">      <span class="attr">"wk"</span>: <span class="string">"2016.6.20 - 2016.6.26（单位：万元）"</span>,</div><div class="line">      <span class="attr">"wboxoffice"</span>: <span class="string">"28690"</span>,</div><div class="line">      <span class="attr">"tboxoffice"</span>: <span class="string">"28690"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"rid"</span>: <span class="string">"2"</span>,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"独立日：卷土重来"</span>,</div><div class="line">      <span class="attr">"wk"</span>: <span class="string">"2016.6.20 - 2016.6.26（单位：万元）"</span>,</div><div class="line">      <span class="attr">"wboxoffice"</span>: <span class="string">"23924"</span>,</div><div class="line">      <span class="attr">"tboxoffice"</span>: <span class="string">"23924"</span></div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"error_code"</span>: <span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们选用 SwiftyJSON 来 map json，创建一个 Protocol:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Mapable</span> </span>&#123;</div><div class="line">    <span class="keyword">init</span>?(jsonData:<span class="type">JSON</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>建立 BoxofficeModel 模型:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BoxofficeModel</span>: <span class="title">Mapable</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> rid: <span class="type">String</span>?</div><div class="line">    <span class="keyword">let</span> name: <span class="type">String</span>?</div><div class="line">    <span class="keyword">let</span> wk: <span class="type">String</span>?</div><div class="line">    <span class="keyword">let</span> wboxoffice: <span class="type">String</span>?</div><div class="line">    <span class="keyword">let</span> tboxoffice: <span class="type">String</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">init</span>?(jsonData: <span class="type">JSON</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.rid = jsonData[<span class="string">"rid"</span>].string</div><div class="line">        <span class="keyword">self</span>.name = jsonData[<span class="string">"name"</span>].string</div><div class="line">        <span class="keyword">self</span>.wk = jsonData[<span class="string">"wk"</span>].string</div><div class="line">        <span class="keyword">self</span>.wboxoffice = jsonData[<span class="string">"wboxoffice"</span>].string</div><div class="line">        <span class="keyword">self</span>.tboxoffice = jsonData[<span class="string">"tboxoffice"</span>].string</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面就是关键点了，怎样分离业务并且 map to objectArray？Show me the code:</p>
<p>首先定义集中错误:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ORMError</span> : <span class="title">ErrorType</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">ORMNoRepresentor</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMNotSuccessfulHTTP</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMNoData</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMCouldNotMakeObjectError</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMBizError</span>(resultCode: <span class="type">Int</span>?, resultMsg: <span class="type">String</span>?)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中 ORMBizError(resultCode: Int?, resultMsg: String?) 是业务错误， 是前台与后台约定好如果 resultCode == “200” 表示业务成功，可以去 data 中取数据。其他数值表示失败，resultMsg 告知失败原因，比如“认真失败”、“key 过期”等等。</p>
<p>接下里，我们对上面的 json 进行处理，既然是使用 RxSwift，map 处理可以是扩展 Observable 方法实现，这样可以在 Rx chain 中调用 map 方法:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ORMError</span> : <span class="title">ErrorType</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">ORMNoRepresentor</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMNotSuccessfulHTTP</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMNoData</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMCouldNotMakeObjectError</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ORMBizError</span>(resultCode: <span class="type">String</span>?, resultMsg: <span class="type">String</span>?)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">BizStatus</span>: <span class="title">String</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">BizSuccess</span> = <span class="string">"200"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">BizError</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">Mapable</span> </span>&#123;</div><div class="line">    <span class="keyword">init</span>?(jsonData:<span class="type">JSON</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> <span class="type">RESULT_CODE</span> = <span class="string">"resultcode"</span></div><div class="line"><span class="keyword">let</span> <span class="type">RESULT_MSG</span> = <span class="string">"reason"</span></div><div class="line"><span class="keyword">let</span> <span class="type">RESULT_DATA</span> = <span class="string">"result"</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Observable</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">resultFromJSON</span>&lt;T: Mapable&gt;<span class="params">(jsonData:JSON, classType: T.<span class="keyword">Type</span>)</span></span> -&gt; <span class="type">T</span>? &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">T</span>(jsonData: jsonData)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapResponseToObjArray</span>&lt;T: Mapable&gt;<span class="params">(type: T.<span class="keyword">Type</span>)</span></span> -&gt; <span class="type">Observable</span>&lt;[<span class="type">T</span>]&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">map</span> &#123; response <span class="keyword">in</span></div><div class="line">            </div><div class="line">            <span class="comment">// get Moya.Response</span></div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> response = response <span class="keyword">as</span>? <span class="type">Moya</span>.<span class="type">Response</span> <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMNoRepresentor</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">// check http status</span></div><div class="line">            <span class="keyword">guard</span> ((<span class="number">200</span>...<span class="number">209</span>) ~= response.statusCode) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMNotSuccessfulHTTP</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">// unwrap biz json shell</span></div><div class="line">            <span class="keyword">let</span> json = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data)</div><div class="line">            </div><div class="line">            <span class="comment">// check biz status</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> code = json[<span class="type">RESULT_CODE</span>].string &#123;</div><div class="line">                <span class="keyword">if</span> code == <span class="type">BizStatus</span>.<span class="type">BizSuccess</span>.rawValue &#123;</div><div class="line">                    <span class="comment">// bizSuccess -&gt; wrap and return biz obj array</span></div><div class="line">                    <span class="keyword">var</span> objects = [<span class="type">T</span>]()</div><div class="line">                    <span class="keyword">let</span> objectsArrays = json[<span class="type">RESULT_DATA</span>].array</div><div class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> array = objectsArrays &#123;</div><div class="line">                        <span class="keyword">for</span> object <span class="keyword">in</span> array &#123;</div><div class="line">                            <span class="keyword">if</span> <span class="keyword">let</span> obj = <span class="keyword">self</span>.resultFromJSON(object, classType:type) &#123;</div><div class="line">                                objects.append(obj)</div><div class="line">                            &#125;</div><div class="line">                        &#125;</div><div class="line">                        <span class="keyword">return</span> objects</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMNoData</span></div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMBizError</span>(resultCode: json[<span class="type">RESULT_CODE</span>].string, resultMsg: json[<span class="type">RESULT_MSG</span>].string)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMCouldNotMakeObjectError</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后在业务层，调用就很方便了:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</div><div class="line">apiProvider.request(<span class="type">ApiService</span>.<span class="type">GetRank</span>(area: <span class="string">"CN"</span>))</div><div class="line">            .mapResponseToObjArray(<span class="type">BoxofficeModel</span>)</div><div class="line">            .subscribe(</div><div class="line">                onNext: &#123; boxofficeModelArray <span class="keyword">in</span></div><div class="line">                  <span class="comment">// do somethong like refresh ui</span></div><div class="line">                &#125;,</div><div class="line">                onError: &#123; error <span class="keyword">in</span></div><div class="line">                    <span class="built_in">print</span>(error)</div><div class="line">                &#125;</div><div class="line">            )</div><div class="line">            .addDisposableTo(disposeBag)</div></pre></td></tr></table></figure>
<p>如果 json data 下的业务数据不是一个 array 而只是一个 object 怎么办呢？其实方法大同小异;</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">mapResponseToObj</span>&lt;T: Mapable&gt;<span class="params">(type: T.<span class="keyword">Type</span>)</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">T</span>?&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">map</span> &#123; representor <span class="keyword">in</span></div><div class="line">            <span class="comment">// get Moya.Response</span></div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> response = representor <span class="keyword">as</span>? <span class="type">Moya</span>.<span class="type">Response</span> <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMNoRepresentor</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">// check http status</span></div><div class="line">            <span class="keyword">guard</span> ((<span class="number">200</span>...<span class="number">209</span>) ~= response.statusCode) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMNotSuccessfulHTTP</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">// unwrap biz json shell</span></div><div class="line">            <span class="keyword">let</span> json = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data)</div><div class="line">            </div><div class="line">            <span class="comment">// check biz status</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> code = json[<span class="type">RESULT_CODE</span>].string &#123;</div><div class="line">                <span class="keyword">if</span> code == <span class="type">BizStatus</span>.<span class="type">BizSuccess</span>.rawValue &#123;</div><div class="line">                    <span class="comment">// bizSuccess -&gt; return biz obj</span></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">self</span>.resultFromJSON(json[<span class="type">RESULT_DATA</span>], classType:type)</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="comment">// bizError -&gt; throw biz error</span></div><div class="line">                    <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMBizError</span>(resultCode: json[<span class="type">RESULT_CODE</span>].string, resultMsg: json[<span class="type">RESULT_MSG</span>].string)</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="type">ORMError</span>.<span class="type">ORMCouldNotMakeObjectError</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>好了，到这里任务算是完成了。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>本文全部代码可运行示例已开源在 Github, 如果我讲的不够明白或者你有更好的解决方法，欢迎斧正、PR:<br><a href="https://github.com/jkyeo/RxMoyaMapperDemo" target="_blank" rel="external">https://github.com/jkyeo/RxMoyaMapperDemo</a></p>
<p>Reference: <a href="https://github.com/artsy/Emergence/blob/master/Emergence/Contexts/Networking/Observable%2BNetworking.swift" target="_blank" rel="external">Observable+Networking</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/06/29/学习-Swift-Moya（二）-Moya-SwiftyJSON-RxSwift/" data-id="cisxyslls0007imwkwqg2fw5r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/swift/">swift</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-学习-Swift-Moya（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/28/学习-Swift-Moya（一）/" class="article-date">
  <time datetime="2016-06-28T09:40:50.000Z" itemprop="datePublished">2016-06-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/28/学习-Swift-Moya（一）/">学习 Swift Moya（一）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="What_is_Moya__uFF1F"><a href="#What_is_Moya__uFF1F" class="headerlink" title="What is Moya ？"></a>What is Moya ？</h2><blockquote>
<p>So the basic idea of Moya is that we want some network abstraction layer that sufficiently encapsulates actually calling Alamofire directly. It should be simple enough that common things are easy, but comprehensive enough that complicated things are also easy.</p>
</blockquote>
<p>Link: <a href="https://github.com/Moya/Moya">https://github.com/Moya/Moya</a></p>
<h2 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h2><blockquote>
<p>Some awesome features of Moya:</p>
<ul>
<li>Compile-time checking for correct API endpoint accesses.</li>
<li>Lets you define a clear usage of different endpoints with associated enum values.</li>
<li>Treats test stubs as first-class citizens so unit testing is super-easy.</li>
</ul>
</blockquote>
        
          <p class="article-more-link">
            <a href="/2016/06/28/学习-Swift-Moya（一）/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/06/28/学习-Swift-Moya（一）/" data-id="cisxyslm2000cimwk0lqqinfx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-《Android-源码设计模式解析与实战》学习笔记（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/17/《Android-源码设计模式解析与实战》学习笔记（一）/" class="article-date">
  <time datetime="2016-05-17T10:29:03.000Z" itemprop="datePublished">2016-05-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/17/《Android-源码设计模式解析与实战》学习笔记（一）/">《Android 源码设计模式解析与实战》学习笔记（一）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="u9762_u5411_u5BF9_u8C61"><a href="#u9762_u5411_u5BF9_u8C61" class="headerlink" title="面向对象"></a>面向对象</h1><h2 id="u5355_u4E00_u804C_u8D23_u539F_u5219_-_Single_Responsibility_Principle"><a href="#u5355_u4E00_u804C_u8D23_u539F_u5219_-_Single_Responsibility_Principle" class="headerlink" title="单一职责原则 - Single Responsibility Principle"></a>单一职责原则 - Single Responsibility Principle</h2><p>就一个类而言，应该仅有一个引起它变化的原因。简单来说，一个类中应该是一组相关性很高的函数、数据的封装。</p>
<h2 id="u5F00_u95ED_u539F_u5219_-_Open_Close_Principle"><a href="#u5F00_u95ED_u539F_u5219_-_Open_Close_Principle" class="headerlink" title="开闭原则 - Open Close Principle"></a>开闭原则 - Open Close Principle</h2><p>软件中的对象（类、模块、函数等）应该对扩展是开发的，但是，对于修改是封闭的。<br>开闭原则知道我们：当软件需要变化时，应该尽量通过扩展的方式来实现变化，而不是通过修改已有的代码来实现。</p>
<h2 id="u91CC_u6C0F_u66FF_u6362_u539F_u5219_-_Liskov_Substitution_Principle"><a href="#u91CC_u6C0F_u66FF_u6362_u539F_u5219_-_Liskov_Substitution_Principle" class="headerlink" title="里氏替换原则 - Liskov Substitution Principle"></a>里氏替换原则 - Liskov Substitution Principle</h2><p>所有引用基类的地方必须能透明地使用其子类的对象。通俗地讲，只要父类能出现的地方子类就可以出现，而且替换为子类也不会产生任何错误或异常。</p>
<p>面向对象语言的三大特点是继承、封装、多态，里氏替换原则就是依赖于继承、多态这两大特性。</p>
<h2 id="u4F9D_u8D56_u5012_u7F6E_u539F_u5219_-_Dependence_Inversion_Principle"><a href="#u4F9D_u8D56_u5012_u7F6E_u539F_u5219_-_Dependence_Inversion_Principle" class="headerlink" title="依赖倒置原则 - Dependence Inversion Principle"></a>依赖倒置原则 - Dependence Inversion Principle</h2><p>一种特定的解耦形式，使得高层的模块不依赖于低层次的模块的实现细节目的。</p>
<p>关键点：</p>
<ul>
<li>1.高层模块不应该依赖底层模块，两者都应该依赖其抽象；</li>
<li>2.抽象不应该依赖细节；</li>
<li>3.细节应该依赖抽象。</li>
</ul>
<h2 id="u63A5_u53E3_u9694_u79BB_u539F_u5219_-_Interface_Segregation_Principle"><a href="#u63A5_u53E3_u9694_u79BB_u539F_u5219_-_Interface_Segregation_Principle" class="headerlink" title="接口隔离原则 - Interface Segregation Principle"></a>接口隔离原则 - Interface Segregation Principle</h2><p>客户端不应该依赖它不需要的接口。另一种定义是：类间的依赖关系应该建立在最小的接口上。</p>
<h2 id="u8FEA_u7C73_u7279_u539F_u5219_-_Law_of_Demeter"><a href="#u8FEA_u7C73_u7279_u539F_u5219_-_Law_of_Demeter" class="headerlink" title="迪米特原则 - Law of Demeter"></a>迪米特原则 - Law of Demeter</h2><p>也称为最少知识原则（Least Knowledge Principle）</p>
<p>一个对象应该对其他的对象有最少的了解。</p>
<p>Only talk to your immediate friends.</p>
<p>最难的不是完成应用的开发工作，而是后续的升级、维护过程中让应用系统能够拥抱变化。这就意味着在满足需求且不破坏系统稳定性的前提下保持高可扩展性、高内聚、低耦合，在经历了各版本的变更之后依然保持清晰、灵活、稳定的系统架构。</p>
<h1 id="u5355_u4F8B_u6A21_u5F0F"><a href="#u5355_u4F8B_u6A21_u5F0F" class="headerlink" title="单例模式"></a>单例模式</h1><p>(未完)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/05/17/《Android-源码设计模式解析与实战》学习笔记（一）/" data-id="cisxysllq0005imwkhh5lyf3l" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/read/">read</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-BasicParamsInterceptor-为-OkHttp-请求添加公共参数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/18/BasicParamsInterceptor-为-OkHttp-请求添加公共参数/" class="article-date">
  <time datetime="2016-04-18T02:00:51.000Z" itemprop="datePublished">2016-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/18/BasicParamsInterceptor-为-OkHttp-请求添加公共参数/">BasicParamsInterceptor - 为 OkHttp 请求添加公共参数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="u80CC_u666F"><a href="#u80CC_u666F" class="headerlink" title="背景"></a>背景</h2><p>在 Android Http API 请求开发中经常遇到这样的需求：每一次请求带上一个或者多个固定不变的参数，例如：</p>
<ul>
<li>设备唯一标识：device_id = 7a4391e28f309c21</li>
<li>业务唯一标识：uid = 2231001</li>
<li>平台类型：platform = android</li>
<li>客户端版本号：version_code = 6</li>
<li>…</li>
</ul>
<p>这些参数是每一次发生请求都需要的，我们姑且称他们为公共参数（或者基础参数）。公共参数一般以 header line、url query 或者 post body(较少) 这些形式插入请求。</p>
        
          <p class="article-more-link">
            <a href="/2016/04/18/BasicParamsInterceptor-为-OkHttp-请求添加公共参数/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/04/18/BasicParamsInterceptor-为-OkHttp-请求添加公共参数/" data-id="cisxysllv0008imwkwla8r2a9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OkHttp/">OkHttp</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-可能是最「轻」的-EventBus-利用-RxJava-打造-EventBus" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/01/可能是最「轻」的-EventBus-利用-RxJava-打造-EventBus/" class="article-date">
  <time datetime="2016-03-01T13:49:26.000Z" itemprop="datePublished">2016-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/01/可能是最「轻」的-EventBus-利用-RxJava-打造-EventBus/">可能是最「轻」的 EventBus - 利用 RxJava 打造 EventBus</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>站在巨人（RxJava）的肩膀上封装了一个简单的 EventBus。 很轻很小，使用也很简单。</p>
<blockquote>
<p>单例模式；<br>按 tag: String 索引；<br>发送/接受 ? extends java.lang.Object；<br>支持在 IO 线程或 UI 线程中执行观察者回调；</p>
</blockquote>
        
          <p class="article-more-link">
            <a href="/2016/03/01/可能是最「轻」的-EventBus-利用-RxJava-打造-EventBus/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/03/01/可能是最「轻」的-EventBus-利用-RxJava-打造-EventBus/" data-id="cisxyslmd0014imwkhtjzekhe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/eventbus/">eventbus</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rxjava/">rxjava</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Retrofit-RxJava-业务状态重定向及分离" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/01/Retrofit-RxJava-业务状态重定向及分离/" class="article-date">
  <time datetime="2016-03-01T02:11:27.000Z" itemprop="datePublished">2016-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/01/Retrofit-RxJava-业务状态重定向及分离/">Retrofit + RxJava 业务状态重定向及分离</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="u95EE_u9898"><a href="#u95EE_u9898" class="headerlink" title="问题"></a>问题</h2><p>本文主要介绍了在 Retrofit + ReJava 环境下更优雅的解决了以下两个问题：</p>
<div class="tip"><br>    <p>1. 将接口业务上的失败重定向到 onError(Throwable e) 输出；</p><br>    <p>2. 业务成功时分离出 data 数据由 onNext(T t) 输出；</p><br></div>
        
          <p class="article-more-link">
            <a href="/2016/03/01/Retrofit-RxJava-业务状态重定向及分离/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/03/01/Retrofit-RxJava-业务状态重定向及分离/" data-id="cisxysllh0002imwkv9bnqbsk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/retrofit/">retrofit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rxjava/">rxjava</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-新公司入职我折腾「科学上网」的那些事" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/28/新公司入职我折腾「科学上网」的那些事/" class="article-date">
  <time datetime="2016-01-28T04:15:31.000Z" itemprop="datePublished">2016-01-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/28/新公司入职我折腾「科学上网」的那些事/">新公司入职我折腾「科学上网」的那些事</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>年关将至，我裸辞了。其中原由就不细说了。还好有公司愿意收留我。<br>入职第一天感觉一切都是美好的。直到行政给我一张小纸条：</p>
<blockquote>
<p>工号: xxxx<br>IP: 192.168.25.x<br>子网掩码: 255.255.255.x<br>网关: 192.168.25.1<br>DNS: x.x.x.x</p>
</blockquote>
<p>对！固定IP。看来自由上网的可能性不大了。<br>吓得我赶紧测试一下，果然连接自己搭建的 shadowsocks 服务时好时坏，丢包严重。ssh vps 也一直 timeout。问题必须解决啊！</p>
        
          <p class="article-more-link">
            <a href="/2016/01/28/新公司入职我折腾「科学上网」的那些事/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jkyeo.com/2016/01/28/新公司入职我折腾「科学上网」的那些事/" data-id="cisxysllz0009imwkdy2mumvr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shadowsocks/">shadowsocks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vps/">vps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/科学上网/">科学上网</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OkHttp/">OkHttp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/">Swift</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eventbus/">eventbus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/read/">read</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/retrofit/">retrofit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rxjava/">rxjava</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shadowsocks/">shadowsocks</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swift/">swift</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/view/">view</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vps/">vps</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科学上网/">科学上网</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/OkHttp/" style="font-size: 10px;">OkHttp</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/android/" style="font-size: 20px;">android</a> <a href="/tags/eventbus/" style="font-size: 10px;">eventbus</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/read/" style="font-size: 10px;">read</a> <a href="/tags/retrofit/" style="font-size: 10px;">retrofit</a> <a href="/tags/rxjava/" style="font-size: 15px;">rxjava</a> <a href="/tags/shadowsocks/" style="font-size: 10px;">shadowsocks</a> <a href="/tags/swift/" style="font-size: 10px;">swift</a> <a href="/tags/view/" style="font-size: 10px;">view</a> <a href="/tags/vps/" style="font-size: 10px;">vps</a> <a href="/tags/科学上网/" style="font-size: 10px;">科学上网</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-iOS-Swift-篇/">SplashView - 一行代码解决闪屏页(广告页) - iOS(Swift) 篇</a>
          </li>
        
          <li>
            <a href="/2016/07/10/SplashView-一行代码解决闪屏页-广告页-Android-篇/">SplashView - 一行代码解决闪屏页(广告页) - Android 篇</a>
          </li>
        
          <li>
            <a href="/2016/06/29/学习-Swift-Moya（二）-Moya-SwiftyJSON-RxSwift/">学习 Swift Moya（二）- Moya + SwiftyJSON + RxSwift</a>
          </li>
        
          <li>
            <a href="/2016/06/28/学习-Swift-Moya（一）/">学习 Swift Moya（一）</a>
          </li>
        
          <li>
            <a href="/2016/05/17/《Android-源码设计模式解析与实战》学习笔记（一）/">《Android 源码设计模式解析与实战》学习笔记（一）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 jk.yeo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>